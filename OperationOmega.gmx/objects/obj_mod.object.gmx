<!--This Document is generated by GameMaker, if you edit it by hand then you do so at your own risk!-->
<object>
  <spriteName>&lt;undefined&gt;</spriteName>
  <solid>0</solid>
  <visible>-1</visible>
  <depth>-10</depth>
  <persistent>0</persistent>
  <parentName>&lt;undefined&gt;</parentName>
  <maskName>&lt;undefined&gt;</maskName>
  <events>
    <event eventtype="0" enumb="0">
      <action>
        <libid>1</libid>
        <id>603</id>
        <kind>7</kind>
        <userelative>0</userelative>
        <isquestion>0</isquestion>
        <useapplyto>-1</useapplyto>
        <exetype>2</exetype>
        <functionname></functionname>
        <codestring></codestring>
        <whoName>self</whoName>
        <relative>0</relative>
        <isnot>0</isnot>
        <arguments>
          <argument>
            <kind>1</kind>
            <string>//Set the size of the GUI to be the same as the screen port
display_set_gui_size(view_wport[0], view_hport[0]);
//Reset the position of the audio listener
audio_listener_position(0, 0, 0);

//Set the weapon icon HUD based on the icon order
secondary_icon_order = global.shipselect*(global.secondary_type[4]+1)-1;

//Start the match with your first energy secondary_selected selected
secondary_selection_position = 2;
change_secondary(1);

//Hold the cursor rotations locally for faster lookup
cursor_rotation[1] = 0;
cursor_rotation[2] = 0;
cursor_rotation[3] = 0;
//Set the cursor drawing color
color_cursor = make_color_rgb(0, 230, 0);
//Initialize the tab selection variable
selected_tab = 1;
//Initialize the cursor secondary name
current_secondary_name = "";
current_secondary_name_alpha = 0;
update_cursor_name = true;
//Initialize the cursor weapon tab images
for(i = 1; i &lt; 5; i++)
    cursor_weapon[i] = (i-1)*8;
    
//Initialize the primary base rate of fire
primary_base_rate = round(60/obj_player.primary_cooldown_base*10)/10;
primary_charge_flash = 1;
alarm[7] = 4;

//Initialize the goliath flag- for handling its passive
if(global.selected_ship[global.mymid] = 3)
    goliath_selected = true;
else
    goliath_selected = false;

//Store the activated flag and playership reference variables locally for faster lookup
player_object[7] = -1;
for(i = 0; i &lt; 8; i += 1)
{
    player_activated[i] = global.activated[i];
    player_object[i] = global.playership[i];
    playerdisconnect[i] = 0;
}

//Initialize the variables used to draw the armor and shield bars
draw_armor_bar = 1;
draw_shield_bar = 1;

//Initialize the variable that holds the previous value of the player's primary firing direction. For comparisons.
previous_primary_direction = -1;

//Initialize the variable that holds the scaling ratio of the screen
screen_scaling_ratio = view_hview[0]/480;

//Hold the map type locally for faster lookup
map_type_space = global.spacemap;

//Initialize the coordinate variables that control the screen offset to create a shaking effect
modify_x = 0;
modify_y = 0;

//Loop through the four secondary weapons
for(i = 1; i &lt;= 4; i++)
{
    //Hold the max stock for each secondary locally
    max_secondary_stock[i] = global.secondary_stock[i];
    //Initialize the weapon availability coloring variables
    weapon_available_color[i] = c_white;
}
      
//Hold the value of the image index of weapon icons corresponding to your team
team_color_index = global.team[global.mymid]-1;

//Initialize chat-related variables
chat_open = false;      //Flag that says whether or not the extended chat window is open
chat_flashing = '';                  //Holds the ending typing character
alarm[5] = 10;                  //Set the time until the ending typing character changes

//Initialize netcode-related timer variables
ping_frame_count = 0;       //Holds the number of frames that have passed since the last ping update
ping_send_timer = 0;        //Holds the time(in frames) until the next ping packet is sent
update_packet_timer = 0;    //Holds the time(in frames) until the next refresh packet is sent
disconnect_timer = 0;       //Holds the time(in frames) since the last update packet was received by the host

//Merge walls together
global.wallsprite = spr_empty;
global.drawwallsprite = spr_empty;
makenewwall = 0;
alarm[4] = 2;

//Set the targetting values
targeted_object = -1;
distance_to_target = 0;
thisplayer = 0;

//Initialize the notice chat
for(i = 0; i &lt;= 4; i += 1)
{
    chatline[i] = "";
    chatcolor[i] = c_black;
    chatalpha[i] = 0;
}
for(i = 0; i &lt;= 16; i += 1)
{
    extchatline[i] = "";
}

//Set the mid to your mid
mid = global.mymid;

//Initialize the flag controlling when the vie zooms back in
view_zoom_out_flag = false;
//Initialize the targeting variable
current_target_object = -1;

//Set the view increments
view_x_increase = 24;
view_y_increase = 15;
view_height_base = 750;
view_hview[0] = view_height_base;

//Initialize the variable that controls the tab box
tab_window_open = false;

//Initialize the respawn locations of all players
for(i = 0; i &lt; 8; i++)
    respawn_location[i] = i;      

</string>
          </argument>
        </arguments>
      </action>
    </event>
    <event eventtype="2" enumb="7">
      <action>
        <libid>1</libid>
        <id>603</id>
        <kind>7</kind>
        <userelative>0</userelative>
        <isquestion>0</isquestion>
        <useapplyto>-1</useapplyto>
        <exetype>2</exetype>
        <functionname></functionname>
        <codestring></codestring>
        <whoName>self</whoName>
        <relative>0</relative>
        <isnot>0</isnot>
        <arguments>
          <argument>
            <kind>1</kind>
            <string>primary_charge_flash = -primary_charge_flash;
alarm[7] = 4;
</string>
          </argument>
        </arguments>
      </action>
    </event>
    <event eventtype="2" enumb="6">
      <action>
        <libid>1</libid>
        <id>605</id>
        <kind>0</kind>
        <userelative>0</userelative>
        <isquestion>0</isquestion>
        <useapplyto>0</useapplyto>
        <exetype>0</exetype>
        <functionname></functionname>
        <codestring></codestring>
        <whoName>self</whoName>
        <relative>0</relative>
        <isnot>0</isnot>
        <arguments>
          <argument>
            <kind>1</kind>
            <string>Zoom the view in slowly</string>
          </argument>
        </arguments>
      </action>
      <action>
        <libid>1</libid>
        <id>603</id>
        <kind>7</kind>
        <userelative>0</userelative>
        <isquestion>0</isquestion>
        <useapplyto>-1</useapplyto>
        <exetype>2</exetype>
        <functionname></functionname>
        <codestring></codestring>
        <whoName>self</whoName>
        <relative>0</relative>
        <isnot>0</isnot>
        <arguments>
          <argument>
            <kind>1</kind>
            <string> //Check if the view is larger than normal
 if(view_hview[0] &gt; view_height_base &amp;&amp; view_zoom_out_flag = false)
 {
   alarm[6] = 1;
   view_wview[0] -= view_x_increase/3;
   view_hview[0] -= view_y_increase/3;
 }

</string>
          </argument>
        </arguments>
      </action>
    </event>
    <event eventtype="2" enumb="5">
      <action>
        <libid>1</libid>
        <id>605</id>
        <kind>0</kind>
        <userelative>0</userelative>
        <isquestion>0</isquestion>
        <useapplyto>0</useapplyto>
        <exetype>0</exetype>
        <functionname></functionname>
        <codestring></codestring>
        <whoName>self</whoName>
        <relative>0</relative>
        <isnot>0</isnot>
        <arguments>
          <argument>
            <kind>1</kind>
            <string>Change the ending typing character</string>
          </argument>
        </arguments>
      </action>
      <action>
        <libid>1</libid>
        <id>603</id>
        <kind>7</kind>
        <userelative>0</userelative>
        <isquestion>0</isquestion>
        <useapplyto>-1</useapplyto>
        <exetype>2</exetype>
        <functionname></functionname>
        <codestring></codestring>
        <whoName>self</whoName>
        <relative>0</relative>
        <isnot>0</isnot>
        <arguments>
          <argument>
            <kind>1</kind>
            <string>//Change the flashing text
if(chat_flashing = '')
 chat_flashing = '|';
else
 chat_flashing = '';
//Set time until next flash
alarm[5] = 10;
</string>
          </argument>
        </arguments>
      </action>
    </event>
    <event eventtype="2" enumb="4">
      <action>
        <libid>1</libid>
        <id>605</id>
        <kind>0</kind>
        <userelative>0</userelative>
        <isquestion>0</isquestion>
        <useapplyto>0</useapplyto>
        <exetype>0</exetype>
        <functionname></functionname>
        <codestring></codestring>
        <whoName>self</whoName>
        <relative>0</relative>
        <isnot>0</isnot>
        <arguments>
          <argument>
            <kind>1</kind>
            <string>Consolidate all the wall objects</string>
          </argument>
        </arguments>
      </action>
      <action>
        <libid>1</libid>
        <id>603</id>
        <kind>7</kind>
        <userelative>0</userelative>
        <isquestion>0</isquestion>
        <useapplyto>-1</useapplyto>
        <exetype>2</exetype>
        <functionname></functionname>
        <codestring></codestring>
        <whoName>self</whoName>
        <relative>0</relative>
        <isnot>0</isnot>
        <arguments>
          <argument>
            <kind>1</kind>
            <string>//Create a surface large enough to hold all wall drawings
global.wallsurface = surface_create(ceil(room_width/16), ceil(room_height/16));

//Begin drawing to the surface
surface_set_target(global.wallsurface);
//Clear the surface
draw_clear_alpha(c_black, 1);
//Have each wall mark its position with a square
draw_set_alpha(1);
with(obj_wall)
{
 draw_set_color(c_dkgray);
 draw_rectangle(x/16, y/16, (x+sprite_width)/16, (y+sprite_height)/16, 0);
}
//Create a sprite from the surface
global.wallsprite = sprite_create_from_surface(global.wallsurface, 0, 0, ceil(room_width/16), ceil(room_height/16), 1, 0, 0, 0);
//Stop drawing to the surface
surface_reset_target();
//Free the surface from memory
surface_free(global.wallsurface);

//Stop execution if there were no walls in the room
if(instance_number(obj_wall) &lt; 1)
 exit;

makenewwall = 1;

//Destroy all walls
with(obj_wall)
 instance_destroy();
 



//Create one of these objects
superwall = instance_create(0, 0, obj_bigwall);
superwall.sprite_index = global.wallsprite;
//Scale the object to actual size
superwall.image_xscale = 16;
superwall.image_yscale = 16;


</string>
          </argument>
        </arguments>
      </action>
    </event>
    <event eventtype="2" enumb="3">
      <action>
        <libid>1</libid>
        <id>605</id>
        <kind>0</kind>
        <userelative>0</userelative>
        <isquestion>0</isquestion>
        <useapplyto>0</useapplyto>
        <exetype>0</exetype>
        <functionname></functionname>
        <codestring></codestring>
        <whoName>self</whoName>
        <relative>0</relative>
        <isnot>0</isnot>
        <arguments>
          <argument>
            <kind>1</kind>
            <string>Reset the cursor weapon to the selected one</string>
          </argument>
        </arguments>
      </action>
      <action>
        <libid>1</libid>
        <id>603</id>
        <kind>7</kind>
        <userelative>0</userelative>
        <isquestion>0</isquestion>
        <useapplyto>-1</useapplyto>
        <exetype>2</exetype>
        <functionname></functionname>
        <codestring></codestring>
        <whoName>self</whoName>
        <relative>0</relative>
        <isnot>0</isnot>
        <arguments>
          <argument>
            <kind>1</kind>
            <string>change_secondary(obj_player.secondary_selected);
</string>
          </argument>
        </arguments>
      </action>
    </event>
    <event eventtype="2" enumb="2">
      <action>
        <libid>1</libid>
        <id>605</id>
        <kind>0</kind>
        <userelative>0</userelative>
        <isquestion>0</isquestion>
        <useapplyto>0</useapplyto>
        <exetype>0</exetype>
        <functionname></functionname>
        <codestring></codestring>
        <whoName>self</whoName>
        <relative>0</relative>
        <isnot>0</isnot>
        <arguments>
          <argument>
            <kind>1</kind>
            <string>Create a screen fading effect</string>
          </argument>
        </arguments>
      </action>
      <action>
        <libid>1</libid>
        <id>603</id>
        <kind>7</kind>
        <userelative>0</userelative>
        <isquestion>0</isquestion>
        <useapplyto>-1</useapplyto>
        <exetype>2</exetype>
        <functionname></functionname>
        <codestring></codestring>
        <whoName>self</whoName>
        <relative>0</relative>
        <isnot>0</isnot>
        <arguments>
          <argument>
            <kind>1</kind>
            <string>//Create the effect to fade the screen to black
instance_create(0, 0, obj_fade_screen);
</string>
          </argument>
        </arguments>
      </action>
    </event>
    <event eventtype="2" enumb="1">
      <action>
        <libid>1</libid>
        <id>605</id>
        <kind>0</kind>
        <userelative>0</userelative>
        <isquestion>0</isquestion>
        <useapplyto>0</useapplyto>
        <exetype>0</exetype>
        <functionname></functionname>
        <codestring></codestring>
        <whoName>self</whoName>
        <relative>0</relative>
        <isnot>0</isnot>
        <arguments>
          <argument>
            <kind>1</kind>
            <string>Force-Quit the game</string>
          </argument>
        </arguments>
      </action>
      <action>
        <libid>1</libid>
        <id>603</id>
        <kind>7</kind>
        <userelative>0</userelative>
        <isquestion>0</isquestion>
        <useapplyto>-1</useapplyto>
        <exetype>2</exetype>
        <functionname></functionname>
        <codestring></codestring>
        <whoName>self</whoName>
        <relative>0</relative>
        <isnot>0</isnot>
        <arguments>
          <argument>
            <kind>1</kind>
            <string>//Close the udp stocket if you are a client
if(global.master = false)
{
    closesocket(global.udpsock);
    closesocket(global.host);
}
//End 39dll
dllfree();
//Return to the appropriate room
if(global.public_game = true)
    room_goto(rm_public_game);
else
    room_goto(rm_private_game);
</string>
          </argument>
        </arguments>
      </action>
    </event>
    <event eventtype="2" enumb="0">
      <action>
        <libid>1</libid>
        <id>605</id>
        <kind>0</kind>
        <userelative>0</userelative>
        <isquestion>0</isquestion>
        <useapplyto>0</useapplyto>
        <exetype>0</exetype>
        <functionname></functionname>
        <codestring></codestring>
        <whoName>self</whoName>
        <relative>0</relative>
        <isnot>0</isnot>
        <arguments>
          <argument>
            <kind>1</kind>
            <string>Respawn the player</string>
          </argument>
        </arguments>
      </action>
      <action>
        <libid>1</libid>
        <id>603</id>
        <kind>7</kind>
        <userelative>0</userelative>
        <isquestion>0</isquestion>
        <useapplyto>-1</useapplyto>
        <exetype>2</exetype>
        <functionname></functionname>
        <codestring></codestring>
        <whoName>self</whoName>
        <relative>0</relative>
        <isnot>0</isnot>
        <arguments>
          <argument>
            <kind>1</kind>
            <string>//respawn if there is stock left
if(global.ships &gt; 0)
{
    tele = instance_create(global.myspawnx, global.myspawny, obj_teleport);
    tele.mid = global.mymid;
    //Loop through the four secondary weapons
    for(i = 1; i &lt;= 4; i++)
    {
        //Hold the max stock for each secondary locally
        global.secondary_stock[i] = max_secondary_stock[i];
    }    
    //Set the armor and shield to their max
    with(obj_player)
    {
        armor = armor_maximum;
        shield = shield_maximum;
    }
    obj_camera.player_object = tele;
    change_secondary(1);
    //destroy the error stopper
    with(obj_respawn_timer)
       instance_destroy();
    //Send respawn to host
    clearbuffer(0);
    packet_label_write(10, global.mymid);
    //Send to everyone if host
    if(global.master = true)
        client_sendall(0, 0);
    else
        //Send to host if client
        sendmessage(global.host, 0, 0, 0);
}
else
{
 //Check for game over if host
 if(global.master = true &amp;&amp; alarm[2] &lt;= 0)
 {
  //Add the player to the elimination count
  if(global.team[global.mymid] = 1)
  {
   global.redteamout += 1;
   //Check if all of red team is eliminated
   if(global.redteam = global.redteamout)
   {
    //Send a message to your chat
    chat_addline_game("Red Team has been eliminated.", 1, 0, mid);          //Add the line to the chat
    chat_addline_game("Blue Team has won the match.", 2, 0, mid);          //Add the line to the chat
    create_announcement("Operation Failed", c_blue);
    global.outcome = 1;

        //Hold the eliminated team value
        var team_eliminated = 1;
        //Set time until returning to waiting room
        alarm[2] = 180;
        //Send the message to all clients
        clearbuffer(0);
        packet_label_write(5, mid);
        writebyte(team_eliminated, 0);
        client_sendall(0, 0);
   }
  }
  else
  {
   global.blueteamout += 1;
   //Check if all of blue team is eliminated
   if(global.blueteam = global.blueteamout)
   {
    //Send a message to your chat
    chat_addline_game("Blue Team has been eliminated.", 2, 0, mid);          //Add the line to the chat
    chat_addline_game("Red Team has won the match.", 1, 0, mid);          //Add the line to the chat
    create_announcement("Operation Failed", c_red);
    global.outcome = 1;
        //Hold the eliminated team value
        var team_eliminated = 1;
        //Set time until returning to waiting room
        alarm[2] = 180;
        //Send the message to all clients
        clearbuffer(0);
        packet_label_write(5, mid);
        writebyte(team_eliminated, 0);
        client_sendall(0, 0);
   }
  }
 }
 else
 {
  //Send elimination to host
  clearbuffer(0);
  packet_label_write(4, global.mymid);
  sendmessage(global.host, 0, 0, 0);
 }  
}
</string>
          </argument>
        </arguments>
      </action>
    </event>
    <event eventtype="3" enumb="2">
      <action>
        <libid>1</libid>
        <id>603</id>
        <kind>7</kind>
        <userelative>0</userelative>
        <isquestion>0</isquestion>
        <useapplyto>-1</useapplyto>
        <exetype>2</exetype>
        <functionname></functionname>
        <codestring></codestring>
        <whoName>self</whoName>
        <relative>0</relative>
        <isnot>0</isnot>
        <arguments>
          <argument>
            <kind>1</kind>
            <string>//Perform action based on the update packet timer
switch(update_packet_timer)
{
    case 0:     //The timer is finished; send the update packet
        //Reset the timer
        update_packet_timer = 10;
        
        //Clear the packet and write the label of the new packet
        clearpack();
        packet_label_write(0, mid);             //0 label means this is the update packet
        crush(global.activated[mid]+1, 3, 0);   //Send your ship's activated value
        
        //Check if your ship is currently alive
        if(global.activated[mid] = 1)
        {
            //Send your ship's position, direction, and speed
            crush(round(obj_player.direction*10), 3600, 0);     //Send your ship's direction
            crush(round(obj_player.facedir*10), 3600, 0);       //Send your ship's facing direction
            crush(round(obj_player.x*10), 65000, 0);            //Send your ship's x coordinate
            crush(round(obj_player.y*10), 65000, 0);            //Send your ship's y coordinate
            crush(round(abs(obj_player.speed*100)), 2500, 0);   ////Send your ship's speed
            
            //Send your ship's prediction variables
            crush(prediction_compress(obj_player.predictturn, obj_player.predictspeed, obj_player.multiplayer_primary_fire_flag), 24, 0);
            
            //Send your ship's status variables
            crush(status_compress(obj_player.smoke, obj_player.ship_status_hacked, obj_player.ship_status_shocked, mid), 64, 0);
            
            //Check if you are currently firing your primary weapon
            if(obj_player.multiplayer_primary_fire_flag = true)
            {               
                //Send your RNG seed and firing direction
                crush(global.primaryRNG[mid], 65536, 0);
                crush(round(obj_player.primary_direction), 360, 0);                
                crush(round(obj_player.primary_overheat*20), 200, 0);      
                if(obj_player.current_primary = 3 || obj_player.current_primary = 9)
                    crush(obj_player.primary_stop_distance, 200, 0); 
            }
        }
        //Loop through the other players to add their updates as well
        for(i = 1; i &lt; 8; i += 1)
        {            
            if(global.activated[i] &lt;= 0) continue;
            crush(global.activated[i]+1, 3, 0);                                     //Send the activation status of the player
            //Move to the next mid if this player isn't active
            if(global.activated[i] != 1) continue;
            //Send the ship's position, direction, and speed            
            crush(round(global.playership[i].direction*10), 3600, 0);               //Send the ship's direction
            crush(round(global.playership[i].facedir*10), 3600, 0);                 //Send the ship's facing direction
            crush(clamp(round(global.playership[i].x*10), 0, 65000), 65000, 0);     //Send the ship's x coordinate
            crush(clamp(round(global.playership[i].y*10), 0, 65000), 65000, 0);     //Send the ship's y coordinate
            crush(round(global.playership[i].speed*100), 2500, 0);                  //Send the ship's speed
            
            //Send the ship's prediction variables            
            crush(prediction_compress(global.playership[i].turning, global.playership[i].speeding, global.playership[i].multiplayer_primary_fire_flag), 24, 0);
            
            //Send the ship's status variables
            crush(status_compress(global.playership[i].smoke, global.playership[i].ship_status_hacked, global.playership[i].ship_status_shocked, i), 64, 0);

            //Check if the player is currently firing their primary weapon
            if(global.playership[i].multiplayer_primary_fire_flag = true)
            {               
                //Send the players' RNG seed and firing direction
                crush(global.primaryRNG[i], 65536, 0);
                crush(round(global.playership[i].primary_direction), 360, 0);                
                crush(round(global.playership[i].primary_overheat*20), 200, 0);                
                if(global.playership[i].current_primary = 3 || global.playership[i].current_primary = 9)
                    crush(global.playership[i].primary_stop_distance, 200, 0); 
            }
        }
        //Send the update packet to everyone
        bufferpack();
        client_sendall(0, 0);
    break;
    default:        //The timer needs to count down
        update_packet_timer -= 1;
    break;     
}

//Send a packet immediately if the primary direction changes
if(global.activated[mid] = 1)
    if(obj_player.primary_direction != previous_primary_direction)
    {
        //Update the previous primary direction
        previous_primary_direction = obj_player.primary_direction;
        //Send a packet to everyone to update your aiming direction
        clearbuffer(0);
        packet_label_write(13, mid);
        writebyte(obj_player.primary_direction/5, 0);
        client_sendall(0, 0);
    }
</string>
          </argument>
        </arguments>
      </action>
    </event>
    <event eventtype="3" enumb="1">
      <action>
        <libid>1</libid>
        <id>603</id>
        <kind>7</kind>
        <userelative>0</userelative>
        <isquestion>0</isquestion>
        <useapplyto>-1</useapplyto>
        <exetype>2</exetype>
        <functionname></functionname>
        <codestring></codestring>
        <whoName>obj_mod</whoName>
        <relative>0</relative>
        <isnot>0</isnot>
        <arguments>
          <argument>
            <kind>1</kind>
            <string>
//This part of the step event deals with player communications
//This is the host object, so it must relay messages to other
//players
//check_disconnect();

//Start the infinite while loop. It will cycle through until 
//there are no new messages
while(true)
{
    //Initialize variables
    //var size;
    size = 0;
    //Check each player one by one for a new message
    for(i = 0; i &lt; ds_list_size(global.clients); i += 1)
    {
        //Check for a tcp message
        size = receivemessage(client_port(i), 0, 0);
        //If a message was received, break the for loop
        if(size &gt; 0) 
        {
            break;
        }
    }
    //If no message was received, break the while loop
    if(size &lt; 0) break;
    if(size = 0) break;////////////////////
    //Read the label byte to find the packet id and the player who sent it
    var lollabel = readbyte(0);
    packet_label_read(lollabel);

  
    //Perform the correct acton depending on what packet has been sent
    switch(packet)
    {
        case 0: //A player has send their refresh packet
            //Reset the disconnection check if needed
            if(playerdisconnect[dummy] &gt; -700)
                playerdisconnect[dummy] = 0;
                
            //Begin reading the packet information
            uncrushbegin();     
            global.activated[dummy] = uncrush(3, 0)-1;          //Read the player's activation status
            //Continue reading the packet if the player is active
            if(global.activated[dummy] = 1)
            {
                global.playership[dummy].direction = uncrush(3600, 0)/10;       //Read the player's direction
                global.playership[dummy].facedir = uncrush(3600, 0)/10;         //Read the player's facing direction
                global.playership[dummy].x = uncrush(65000, 0)/10;              //Read the player's x coordinate
                global.playership[dummy].y = uncrush(65000, 0)/10;              //Read the player's y coordinate
                global.playership[dummy].speed = uncrush(2500, 0)/100;          //Read the player's speed
        
                //Read the player's prediction variables
                var decomp = uncrush(24, 0);
                prediction_decompress(decomp);
                
                //Read the player's status variables
                decomp = uncrush(64, 0);
                status_decompress(decomp);
                
                //Check if the player is firing their primary weapon
                if(global.playership[dummy].multiplayer_primary_fire_flag = true)
                {
                    //Read the player's RNG seed and firing direction
                    global.primaryRNG[dummy] = uncrush(65536, 0);
                    global.playership[dummy].primary_direction = uncrush(360, 0);
                    global.playership[dummy].primary_overheat = uncrush(200, 0)/20;
                    if(global.playership[dummy].current_primary = 3 || global.playership[dummy].current_primary = 9)
                        global.playership[dummy].primary_stop_distance = uncrush(200, 0);
                }
            }
        break;
   
        case 1: //The player sends its ping packet
            var lolstatuses = readbyte(0);
            status_decompress(lolstatuses);
            if(global.playership[dummy].ship_status_hacked = true)
            {
                global.playership[dummy].thisturn = 0;
                global.playership[dummy].turning = 0;
                global.playership[dummy].speeding = 2;
            }
            global.ping[dummy] = readbyte(0)*20;
            global.playerfps[dummy] = readbyte(0);
            client_sendall(0, 0);    
        break;
   
        case 2: //The player uses a secondary weapon
            receive_secondary();
        break;
   
        case 3: //The player is defeated
            //Push back the disconnection check
            playerdisconnect[dummy] = -600;
            
            //Send the mid of the player that defeated this player
            global.playership[dummy].defeatmid = readbyte(0);
            
            var dead_message = readstring(0);
            var dead_color = readbyte(0);
            //Send a defeat notice to chat
            chat_addline_game(dead_message, dead_color, 0, dummy);          //Add the line to the chat
            
            //Perform the defeat function for the player
            with(global.playership[dummy])
                event_perform(ev_other, ev_user2);      
                
            //Read the respawn location for the player
            respawn_location[dummy] = readbyte(0);      
            //Create an announcement
            if(global.playership[dummy].defeatmid != 20)
            {
                var new_announcement = readstring(0);
                create_announcement(new_announcement, obj_chat.chat_line_color[1]);
            }
                
            //Send the message to other players
            client_sendall(0, dummy);
        break;  
  
        //A player is eliminated in a stock match
        case 4:
            //Skip this if the game is ending
            if(alarm[2] &gt; 0)
                exit;
                
            //Push back the disconnect check
            playerdisconnect[dummy] = -700;
            
            //Perform action depending on the team
            if(global.team[dummy] = 1)
            {
                //Add the player to the elimination count
                global.redteamout += 1;
                //Check if every red team member is eliminated
                if(global.redteam = global.redteamout)
                {
                    //Send a message to your chat
                    chat_addline_game("Red Team has been eliminated.", 1, 0, dummy);          //Add the line to the chat
                    chat_addline_game("Blue Team has won the match.", 2, 0, dummy);          //Add the line to the chat
                    
                    //Display an announcement
                    if(global.team[mid] = 1)
                    {
                        create_announcement("Operation Failed", c_blue);
                        global.outcome = 1;
                    }
                    else
                    {
                        create_announcement("Operation Successful", c_blue);
                        global.outcome = 0;
                    }         
                    
                    //Hold the eliminated team value
                    var team_eliminated = 1;
                    //Set time until returning to waiting room
                    alarm[2] = 180;
                    //Send the message to all clients
                    clearbuffer(0);
                    packet_label_write(5, mid);
                    writebyte(team_eliminated, 0);
                    client_sendall(0, 0);
                }
            }
            else
            {
                //Add the player to the elimination count
                global.blueteamout += 1;
                //Check if every blue team member is eliminated
                if(global.blueteam = global.blueteamout)
                {
                    //Send a message to your chat
                    chat_addline_game("Blue Team has been eliminated.", 2, 0, dummy);          //Add the line to the chat
                    chat_addline_game("Red Team has won the match.", 1, 0, dummy);          //Add the line to the chat
                    
                    //Display an announcement
                    if(global.team[mid] = 1)
                    {
                        create_announcement("Operation Successful", c_red);
                        global.outcome = 0;
                    }
                    else
                    {
                        create_announcement("Operation Failed", c_red);
                        global.outcome = 1;
                    }
                    //Hold the eliminated team value
                    var team_eliminated = 2;
                    //Set time until returning to waiting room
                    alarm[2] = 180;
                    //Send the message to all clients
                    clearbuffer(0);
                    packet_label_write(5, mid);
                    writebyte(team_eliminated, 0);
                    client_sendall(0, 0);
                }
            }
        break;
   
        //Prediction Packet
        case 6:
            client_sendall(1, dummy);
        break;  
        
        //Chat Message
        case 7:
            //Put the message in your chat
            var chat_message = readstring(0);
            var chat_color = global.team[dummy];
            chat_addline_game(chat_message, chat_color, 0, dummy);          //Add the line to the chat
            client_sendall(0, dummy);  
        break;

        //Respawn Packet
        case 10:
            tele = instance_create(global.spawnx[respawn_location[dummy]], global.spawny[respawn_location[dummy]], obj_teleport);
            tele.mid = dummy;
            client_sendall(0, dummy);        
        break;  

        //Primary Switched
        case 11:
            global.playerprimary[dummy] = uncrush(0, 73);
            client_sendall(0, dummy);
        break;
   
        //Change primary direction
        case 13:   
            global.playership[dummy].primary_direction = readbyte(0)*5;
            client_sendall(0, dummy);
        break;
   
        //Begin Firing Primary weapon
        case 14:
            global.primaryRNG[dummy] = readushort(0);
            client_sendall(0, dummy);
        break;
   
        //Change hacked status
        case 15:
            global.playership[dummy].ship_status_hacked = true;
            global.playership[dummy].alarm[5] = 90;        
            client_sendall(0, dummy);
        break;
        
        //Destroy paladin drone for player
        case 16:
            var pass_mid = dummy;
            if(global.team[dummy] = global.team[global.mymid])
            {
                with(obj_paladindrone)
                    if(mid = pass_mid)
                        instance_destroy();
            }
            else
            {
                with(obj_paladindrone_enemy)
                    if(mid = pass_mid)
                        instance_destroy();
            }
            client_sendall(0, dummy);
        break;
        
        //Push a ship
        case 17:
            var push_effect = instance_create(0, 0, obj_buster_push);
            push_effect.target_object = global.playership[dummy];
            push_effect.push_direction = readshort(0);
            push_effect.amplified = readbyte(0);
            client_sendall(0, dummy);
        break;
        
        //Shoot a charge shot
        case 18:
            var dummy_ship = global.playership[dummy];
            dummy_ship.x = readshort(0);
            dummy_ship.y = readshort(0);
            dummy_ship.facedir = readshort(0);
            dummy_ship.speed = readshort(0);
            dummy_ship.primary_direction = readshort(0);
            dummy_ship.give_target_x = readshort(0);
            dummy_ship.give_target_y = readshort(0);
            
            with(dummy_ship)
                event_perform(ev_other, ev_user3);
            client_sendall(0, dummy);
        break;
        
        //A player leaves the game
        case CLIENT_DROP:
            //Get info from leaving player
            droppedname = readstring(0);
            //Drop the player and add the drop to the count
            client_drop(dummy);
            //Destroy the removed player
            with(global.playership[dummy])
            {
                defeatmid = 20;
                event_perform(ev_other, ev_user2);
                //Send a notice to your chat
                chat_addline_game(readstring(0), global.team[dummy], 0, dummy);          //Add the line to the chat

                //Relay the info to other players
                client_sendall(0, 0); 
                //Add the player to the elimination count
                if(global.team[dummy] = 1)
                {
                    //Check if all of red team is eliminated
                    if(global.redteam = global.redteamout)
                    {
                        //Send it to your chat
                        //Send a message to your chat
                        chat_addline_game("Red Team has been eliminated.", 1, 0, dummy);          //Add the line to the chat
                        chat_addline_game("Blue Team has won the match.", 2, 0, dummy);          //Add the line to the chat
                        if(global.team[mid] = 1)
                        {
                            global.outcome = 1;
                            create_announcement("Operation Failed", c_blue);
                        }
                        else
                        {
                            global.outcome = 0;
                            create_announcement("Operation Successful", c_blue);
                        }
                                    
                        //Hold the eliminated team value
                        var team_eliminated = 1;
                        //Set time until returning to waiting room
                        alarm[2] = 180;
                        //Send the message to all clients
                        clearbuffer(0);
                        packet_label_write(5, disi);
                        writebyte(team_eliminated, 0);
                        client_sendall(0, 0);
                    }
                }
                else
                {
                    //Check if all of blue team is eliminated
                    if(global.blueteam = global.blueteamout)
                    {
                        //Send it to your chat
                        //Send a message to your chat
                        chat_addline_game("Blue Team has been eliminated.", 2, 0, dummy);          //Add the line to the chat
                        chat_addline_game("Red Team has won the match.", 1, 0, dummy);          //Add the line to the chat
                        if(global.team[mid] = 2)
                        {
                            global.outcome = 1;
                            create_announcement("Operation Failed", c_red);
                        }
                        else
                        {
                            global.outcome = 0;
                            create_announcement("Operation Successful", c_red);
                        }
                        //Hold the eliminated team value
                        var team_eliminated = 1;
                        //Set time until returning to waiting room
                        alarm[2] = 180;
                        //Send the message to all clients
                        clearbuffer(0);
                        packet_label_write(5, disi);
                        writebyte(team_eliminated, 0);
                        client_sendall(0, 0);
                    }
                }   
            }
        break;
   }
} 
//Listen for a new player
newclient = tcpaccept(global.listen, true);
if(newclient &gt; 0)
{
    //Reject the new player
    clearbuffer(0);
    writebyte(CLIENT_UNABLE, 0);
    sendmessage(newclient, 0, 0, 0);
}   
</string>
          </argument>
        </arguments>
      </action>
    </event>
    <event eventtype="3" enumb="0">
      <action>
        <libid>1</libid>
        <id>603</id>
        <kind>7</kind>
        <userelative>0</userelative>
        <isquestion>0</isquestion>
        <useapplyto>-1</useapplyto>
        <exetype>2</exetype>
        <functionname></functionname>
        <codestring></codestring>
        <whoName>self</whoName>
        <relative>0</relative>
        <isnot>0</isnot>
        <arguments>
          <argument>
            <kind>1</kind>
            <string>//This part of the step event is the personal checks
//Things here will not be sent to/received by other players.

//Check if the tab box should be displayed
if(tab_window_open = false)
    if(keyboard_check_direct(vk_tab))
    {
        tab_window_open = true;
        instance_create(0, 0, obj_tab_box);
    }
    
//Handle cursor weapon tabs
for(i = 1; i &lt; 5; i++)
{
    if(selected_tab = i)
        cursor_weapon[i] = min(cursor_weapon[i]+1, i*8-1);
    else
        cursor_weapon[i] = max(cursor_weapon[i]-1, (i-1)*8);        
}

//Update the selected secondary's name string
var current_length = string_length(current_secondary_name);
if(update_cursor_name = true)
{
    if(current_length &lt; string_length(cursor_secondary_name))
    {
        current_secondary_name = string_insert(string_copy(cursor_secondary_name, current_length+1, 1), current_secondary_name, current_length+1);
        update_cursor_name = false;
    }
    else
        current_secondary_name_alpha -= 0.03;
}
else
    update_cursor_name = true;

if((view_xview[0] &gt; 0 &amp;&amp; view_xview[0]+view_wview[0] &lt; room_width))
{
    if(map_type_space = 1)
    { 
        background_hspeed[0]=obj_camera.player_object.hspeed/1.2;
        background_hspeed[2]=(obj_camera.player_object.hspeed+back_extrahspeed)/2;
        background_hspeed[3]=(obj_camera.player_object.hspeed+back_extrahspeed)/3;
        background_hspeed[4]=(obj_camera.player_object.hspeed+back_extrahspeed)/4;
        background_hspeed[5]=(obj_camera.player_object.hspeed+back_extrahspeed)/5.5;
        background_hspeed[6]=(obj_camera.player_object.hspeed+back_extrahspeed)/8;
    }
    background_hspeed[6]=(obj_camera.player_object.hspeed+back_extrahspeed)/8;    
    background_hspeed[1]=obj_camera.player_object.hspeed/1.2;
}
else
{
    background_hspeed[0]=0;
    background_hspeed[1]=0;
    background_hspeed[2]=back_extrahspeed/2;
    background_hspeed[3]=back_extrahspeed/3;
    background_hspeed[4]=back_extrahspeed/4;
    background_hspeed[5]=back_extrahspeed/5.5;
    background_hspeed[6]=back_extrahspeed/8;
}
if((view_yview[0]&gt;0&amp;&amp;view_yview[0]+view_hview[0]&lt;room_height))
{
    if(map_type_space = 1)
    { 
        background_vspeed[0]=obj_camera.player_object.vspeed/1.2;
        background_vspeed[2]=(obj_camera.player_object.vspeed+back_extravspeed)/2;
        background_vspeed[3]=(obj_camera.player_object.vspeed+back_extravspeed)/3;
        background_vspeed[4]=(obj_camera.player_object.vspeed+back_extravspeed)/4;
        background_vspeed[5]=(obj_camera.player_object.vspeed+back_extravspeed)/5.5;
        background_vspeed[6]=(obj_camera.player_object.vspeed+back_extravspeed)/8;
    }
    
    background_vspeed[6]=(obj_camera.player_object.vspeed+back_extravspeed)/8;
    background_vspeed[1]=obj_camera.player_object.vspeed/1.2;
}
else
{
    background_vspeed[0]=0;
    background_vspeed[1]=0;
    background_vspeed[2]=back_extravspeed/2;
    background_vspeed[3]=back_extravspeed/3;
    background_vspeed[4]=back_extravspeed/4;
    background_vspeed[5]=back_extravspeed/5.5;
    background_vspeed[6]=back_extravspeed/8;
}

//Rotate the cursor parts
cursor_rotation[1] += 2.5;
cursor_rotation[2] -= 4;
cursor_rotation[3] += 6;

</string>
          </argument>
        </arguments>
      </action>
    </event>
    <event eventtype="6" enumb="61">
      <action>
        <libid>1</libid>
        <id>603</id>
        <kind>7</kind>
        <userelative>0</userelative>
        <isquestion>0</isquestion>
        <useapplyto>-1</useapplyto>
        <exetype>2</exetype>
        <functionname></functionname>
        <codestring></codestring>
        <whoName>self</whoName>
        <relative>0</relative>
        <isnot>0</isnot>
        <arguments>
          <argument>
            <kind>1</kind>
            <string>switch(secondary_selection_position)
{
 case 2:
    event_perform(ev_keypress, ord('2'));
 break;
 case 42:
    event_perform(ev_keypress, ord('3'));
 break;
 case 82:
    event_perform(ev_keypress, ord('1'));
 break;
} 
</string>
          </argument>
        </arguments>
      </action>
    </event>
    <event eventtype="6" enumb="60">
      <action>
        <libid>1</libid>
        <id>603</id>
        <kind>7</kind>
        <userelative>0</userelative>
        <isquestion>0</isquestion>
        <useapplyto>-1</useapplyto>
        <exetype>2</exetype>
        <functionname></functionname>
        <codestring></codestring>
        <whoName>self</whoName>
        <relative>0</relative>
        <isnot>0</isnot>
        <arguments>
          <argument>
            <kind>1</kind>
            <string>switch(secondary_selection_position)
{
 case 2:
    event_perform(ev_keypress, ord('3'));
 break;
 case 42:
    event_perform(ev_keypress, ord('1'));
 break;
 case 82:
    event_perform(ev_keypress, ord('2'));
 break;
} 
</string>
          </argument>
        </arguments>
      </action>
    </event>
    <event eventtype="6" enumb="54">
      <action>
        <libid>1</libid>
        <id>603</id>
        <kind>7</kind>
        <userelative>0</userelative>
        <isquestion>0</isquestion>
        <useapplyto>-1</useapplyto>
        <exetype>2</exetype>
        <functionname></functionname>
        <codestring></codestring>
        <whoName>self</whoName>
        <relative>0</relative>
        <isnot>0</isnot>
        <arguments>
          <argument>
            <kind>1</kind>
            <string>//Exit if the player is alive
if(obj_player.armor &gt; 0)
 exit;

//Loop to find the mid value of the currently viewed player
for(i = 0; i &lt; 8; i += 1)
{
 //Skip if not active
 if(global.activated[i] = 0 &amp;&amp; i &gt; 0) continue;
 if(global.playership[i] = obj_camera.player_object)
 {
  //Reset view trigger
  var foundview = 0;
  //Loop through the mids following the viewed mid
  for(ii = i+1; ii &lt; 8; ii += 1)
  {
   //Skip inactive slots and dead players
   if(global.activated[ii] = 0 &amp;&amp; ii &gt; 0) continue;  
   if(global.playership[ii].x &gt; room_width || global.playership[ii] = obj_dud) continue;
   //Set the view to follow the found player
   obj_camera.player_object = global.playership[ii];
   foundview = 1;
   break;
  }
  //If no player has yet been found, loop through mids before the viewed mid
  if(foundview = 0)
   for(ii = 0; ii &lt; i; ii += 1)
   {
    //Skip inactive slots and dead players
    if(global.activated[ii] = 0 &amp;&amp; ii &gt; 0) continue;  
    if(global.playership[ii].x &gt; room_width || global.playership[ii] = obj_dud) continue;
    //Set the view to follow the found player
    obj_camera.player_object = global.playership[ii];
    break;
   }
  break;
 }
}
</string>
          </argument>
        </arguments>
      </action>
    </event>
    <event eventtype="6" enumb="53">
      <action>
        <libid>1</libid>
        <id>603</id>
        <kind>7</kind>
        <userelative>0</userelative>
        <isquestion>0</isquestion>
        <useapplyto>-1</useapplyto>
        <exetype>2</exetype>
        <functionname></functionname>
        <codestring></codestring>
        <whoName>self</whoName>
        <relative>0</relative>
        <isnot>0</isnot>
        <arguments>
          <argument>
            <kind>1</kind>
            <string>//Exit if the player is alive
if(obj_player.armor &gt; 0)
 exit;

//Loop to find the mid value of the currently viewed player
for(i = 0; i &lt; 8; i += 1)
{
 //Skip if not active
 if(global.activated[i] = 0 &amp;&amp; i &gt; 0) continue;
 if(global.playership[i] = obj_camera.player_object)
 {
  //Reset view trigger
  foundview = 0;
  //Loop through the mids following the viewed mid
  for(ii = i+1; ii &lt; 8; ii += 1)
  {
   //Skip inactive slots and dead players
   if(global.activated[ii] = 0 &amp;&amp; ii &gt; 0) continue;  
   if(global.playership[ii].x &gt; room_width || global.playership[ii] = obj_dud) continue;
   //Set the view to follow the found player
   obj_camera.player_object = global.playership[ii];
   foundview = 1;
   break;
  }
  //If no player has yet been found, loop through mids before the viewed mid
  if(foundview = 0)
   for(ii = 0; ii &lt; i; ii += 1)
   {
    //Skip inactive slots and dead players
    if(global.activated[ii] = 0 &amp;&amp; ii &gt; 0) continue;  
    if(global.playership[ii].x &gt; room_width || global.playership[ii] = obj_dud) continue;
    //Set the view to follow the found player
    obj_camera.player_object = global.playership[ii];
    break;
   }
  break;
 }
}

</string>
          </argument>
        </arguments>
      </action>
    </event>
    <event eventtype="7" enumb="5">
      <action>
        <libid>1</libid>
        <id>603</id>
        <kind>7</kind>
        <userelative>0</userelative>
        <isquestion>0</isquestion>
        <useapplyto>-1</useapplyto>
        <exetype>2</exetype>
        <functionname></functionname>
        <codestring></codestring>
        <whoName>self</whoName>
        <relative>0</relative>
        <isnot>0</isnot>
        <arguments>
          <argument>
            <kind>1</kind>
            <string>//Loop through the four secondary weapons
for(i = 1; i &lt;= 4; i++)
{
    //Hold the max stock for each secondary locally
    global.secondary_stock[i] = max_secondary_stock[i];
}

//Delete temporary data from memory
sprite_delete(global.wallsprite);
background_delete(global.starback[0]);
background_delete(global.starback[1]);
background_delete(global.starback[2]);
init_menuback();
switch(global.matchroom)
{
    case rm_katrinbase:
         background_delete(global.background[0]);
         background_delete(global.backpiece_1); 
         background_delete(global.backpiece_2); 
         background_delete(global.backpiece_3); 
    break;
    case rm_combatzone:
         background_delete(global.background[0]);
         background_delete(global.background[2]);
         background_delete(global.background[3]);
         background_delete(global.background[4]);
         background_delete(global.background[5]);
         background_delete(global.background[7]);
         background_delete(global.backpiece_1); 
         background_delete(global.backpiece_2); 
         background_delete(global.backpiece_3); 
    break;
    case rm_victatundra:
         background_delete(global.background[0]);
         background_delete(global.background[2]);
         background_delete(global.background[4]);
         background_delete(global.background[7]); 
         background_delete(global.backpiece_1); 
         background_delete(global.backpiece_2); 
         background_delete(global.backpiece_3); 
         background_delete(global.cloudback);        
    break;
    case rm_barricade:
         background_delete(global.background[0]);
         background_delete(global.background[1]);
         background_delete(global.background[2]);
         background_delete(global.background[4]);
         background_delete(global.background[5]);
         background_delete(global.background[7]);      
         background_delete(global.backpiece_1); 
         background_delete(global.backpiece_2); 
         background_delete(global.backpiece_3); 
    break;
    case rm_victabase:
         background_delete(global.background[0]);
         background_delete(global.backpiece_1); 
         background_delete(global.backpiece_2); 
         background_delete(global.backpiece_3);        
    break;
    case rm_satellite:
         background_delete(global.background[0]);
         background_delete(global.background[1]);
         background_delete(global.background[2]);
         background_delete(global.background[4]);
         background_delete(global.background[5]);
         background_delete(global.background[7]);      
    break;
    case rm_katrincoast:
         background_delete(global.background[0]);
         background_delete(global.backpiece_1); 
         background_delete(global.backpiece_2); 
         background_delete(global.backpiece_3);        
    break;
    case rm_spacedepot:
         background_delete(global.background[0]);
         background_delete(global.background[2]);
         background_delete(global.background[4]);
         background_delete(global.background[5]);
         background_delete(global.background[7]);      
         background_delete(global.backpiece_1); 
         background_delete(global.backpiece_2); 
         background_delete(global.backpiece_3); 
    break;
    case rm_orbitstation:
         background_delete(global.background[0]);
         background_delete(global.background[2]);
         background_delete(global.background[4]);
         background_delete(global.background[5]);
         background_delete(global.background[7]);      
         background_delete(global.backpiece_1); 
         background_delete(global.backpiece_2); 
         background_delete(global.backpiece_3); 
    break;
} 


//audio_stop_all();
draw_texture_flush();
cleanmem();

</string>
          </argument>
        </arguments>
      </action>
    </event>
    <event eventtype="8" enumb="75">
      <action>
        <libid>1</libid>
        <id>603</id>
        <kind>7</kind>
        <userelative>0</userelative>
        <isquestion>0</isquestion>
        <useapplyto>-1</useapplyto>
        <exetype>2</exetype>
        <functionname></functionname>
        <codestring></codestring>
        <whoName>self</whoName>
        <relative>0</relative>
        <isnot>0</isnot>
        <arguments>
          <argument>
            <kind>1</kind>
            <string>var current_secondary = obj_player.secondary_selected;
var current_secondary_stock = global.secondary_stock[selected_tab];

screen_scaling_ratio = view_hview[0]/480;
texture_set_interpolation(false);

//If you are targeting an enemy, draw the targetting cursor
if(targeted_object != -1)
{
    var target_cursor_x = (targeted_object.x-view_xview[0])/screen_scaling_ratio;
    var target_cursor_y = (targeted_object.y-view_yview[0])/screen_scaling_ratio;
    if(!instance_exists(obj_lockoncursor))
        draw_sprite_ext(spr_targetcursor, distance_to_target, target_cursor_x, target_cursor_y, 1, 1, cursor_rotation[2], c_white, 0.7);
} 

//Draw equipped weapons
check_weapons();
//Draw the gauge backgrounds
draw_sprite_ext(spr_gauges, 0, 0, 0, 1, 1, 0, c_white, 1);

//Draw Armor, Shield, Energy, and Ammo bars
if(obj_player.armor &gt; 0)
{
    armorratio = obj_player.armor/obj_player.armor_maximum;
    if(armorratio &lt; draw_armor_bar)
        draw_armor_bar -= 0.02;
    else
        draw_armor_bar = armorratio;
    draw_sprite_part_ext(spr_armorbar, 0, 0, 0, 4+draw_armor_bar*233, 86, 0, 0, 1, 1, c_white, 1);
}
if(obj_player.shield &gt; 0)
{
    shieldratio = obj_player.shield/obj_player.shield_maximum;
    if(shieldratio &lt; draw_shield_bar)
        draw_shield_bar -= 0.02;
    else
        draw_shield_bar = shieldratio;
    draw_sprite_part_ext(spr_shieldbar, 0, 0, 0, 4+draw_shield_bar*233, 86, 0, 0, 1, 1, c_white, 0.4+(0.6*shieldratio));
}
else
    draw_shield_bar = 0;    

var energy_ratio = current_secondary_stock/100;
var heavy_ratio = current_secondary_stock/max_secondary_stock[current_secondary];

//Draw the match status
switch(global.matchtype)
{
 case "stock":
    draw_sprite_ext(spr_lifecount, global.shipselect*global.team[mid], 18, 15, 1, 1, 0, c_white, 1);
    draw_set_font(fnt_chat);
    draw_text_bordered(37, 7, "x "+string(global.ships), 1, 1, c_black, c_white);
 break;
 case "death":
      draw_set_font(fnt_chat);
      draw_set_alpha(0.7);
      draw_set_color(global.matchcolor);
      minute = floor(date_minute_span(global.time, global.endtime));
      second = floor(date_second_span(global.time, global.endtime)-minute*60);
      draw_text_transformed(10, 5, string(minute)+":"+string(second), 1, 1, 0);
 break;
}

//Draw the radar
draw_sprite_ext(spr_radar, 0, view_wport[0], 0, 1, 1, 0, c_white, 1);
//Draw the map of the walls
draw_sprite_part_ext(global.wallsprite, 0, (obj_player.x-1600)/16, (obj_player.y-1600)/16, 200, 200, view_wport[0]-120, 16, 0.5, 0.5, c_white, 0.8);
//Check which loop to set to
for(i = 0; i &lt; 8; i += 1)
{
    //Check to make sure the current number is not your own if you are not master
    if(mid != i &amp;&amp; (global.activated[i] = 1 || i = 0))
    {
        radarpoint = global.team[i]-1;
        //Set radar point position
        //radardist = point_distance(obj_player.x, obj_player.y, global.playership[radarplayer].x, global.playership[radarplayer].y);
        radarx = (global.playership[i].x-obj_player.x)/30;
        radary = (global.playership[i].y-obj_player.y)/30;
        //Draw radar point if it is in range
        if(abs(radarx) &lt;51 &amp;&amp; abs(radary) &lt; 51)
            draw_sprite_ext(spr_radar_player, radarpoint, view_wport[0]-68+radarx, 68+radary, 1, 1, global.playership[i].image_angle, c_white, 1);
    }
}
  
//draw_set_font(fnt_chat);
draw_set_color(c_white);
draw_text_transformed(10, view_hport[0]-20, string(fps), 1, 1, 0);

//Draw the view size in the radar
var view_box_left, view_box_right, view_box_top, view_box_bottom;
view_box_left = view_wport[0]-68+((view_xview[0]-obj_player.x)/30);
view_box_right = view_box_left+(view_wview[0]/30);
view_box_top = 68+((view_yview[0]-obj_player.y)/30);
view_box_bottom = view_box_top+(view_hview[0]/30);
draw_rectangle(max(view_wport[0]-120,view_box_left), max(16, view_box_top), min(view_wport[0]-19, view_box_right), min(117, view_box_bottom), true);


//Draw the framerate
draw_text_transformed(10, view_hport[0]-20, string(fps), 1, 1, 0);


//Draw the cursor
texture_set_interpolation(true);
var mouse_cursor_x = (mouse_x-view_xview[0])/screen_scaling_ratio;
var mouse_cursor_y = (mouse_y-view_yview[0])/screen_scaling_ratio;
draw_sprite_ext(spr_cursor, 0, mouse_cursor_x, mouse_cursor_y, 0.7, 0.7, cursor_rotation[1], c_white, 0.7);
draw_sprite_ext(spr_cursor, 1, mouse_cursor_x, mouse_cursor_y, 0.7, 0.7, cursor_rotation[2], c_white, 0.7);
draw_sprite_ext(spr_cursor, 2, mouse_cursor_x, mouse_cursor_y, 0.7, 0.7, cursor_rotation[3], c_white, 0.7);


//Draw the switched weapon icon
with(obj_change_weapon)
{
    draw_sprite_ext(weapon_image, image, mouse_cursor_x, mouse_cursor_y, image_xscale, image_yscale, 0, c_white, image_alpha*(1-white_alpha));
    draw_sprite_ext(spr_icon_white, -1, mouse_cursor_x, mouse_cursor_y, image_xscale, image_yscale, 0, c_white, image_alpha*white_alpha);
}

//Prepare the font for the cursor's text
draw_set_font(fnt_cursor);
draw_set_halign(fa_right);
draw_set_valign(fa_middle);
draw_set_color(color_cursor);
draw_set_alpha(0.9);


//Draw the cursor energy bar if the selected secondary is an energy weapon
if(global.secondary_type[selected_tab] = 0)
{
    //Calculate the size of the bar to be displayed
    var energy_bar_size = (1-energy_ratio)*60;
    //Draw the remaining energy
    draw_sprite_part_ext(spr_cursor, 6, 0, energy_bar_size, 131, 60, mouse_cursor_x-59, mouse_cursor_y-30+energy_bar_size, 1, 1, c_white, 0.9);
    //Draw the empty bar
    draw_sprite_part_ext(spr_cursor, 7, 0, 0, 131, energy_bar_size, mouse_cursor_x-59, mouse_cursor_y-30, 1, 1, c_white, 0.9);
    //Draw the number of uses remaining
    draw_text(mouse_cursor_x+52, mouse_cursor_y, floor(current_secondary_stock/global.secondary_cost[selected_tab]));
}
else
{
    //Calculate the size of the bar to be displayed
    if(selected_tab != 4)
        var heavy_bar_size = (1-heavy_ratio)*60;
    else
        var heavy_bar_size = (1-(global.secondary_stock[4]/max_secondary_stock[4]))*60;    
    //Draw the remaining energy
    draw_sprite_part_ext(spr_cursor, 6, 0, heavy_bar_size, 131, 60, mouse_cursor_x-59, mouse_cursor_y-30+heavy_bar_size, 1, 1, c_white, 0.9);
    //Draw the empty bar
    draw_sprite_part_ext(spr_cursor, 7, 0, 0, 131, heavy_bar_size, mouse_cursor_x-59, mouse_cursor_y-30, 1, 1, c_white, 0.9);
    //Draw the number of uses remaining
    draw_text(mouse_cursor_x+52, mouse_cursor_y, current_secondary_stock);
}

if(targeted_object != -1)
    if(global.secondary_lockon_required[selected_tab] = true)
    {
        //Find the direction from the cursor to the target
        var _lockon_direction = point_direction(mouse_cursor_x, mouse_cursor_y, target_cursor_x, target_cursor_y);
        //Find the distance between the cursor and the target
        var _lockon_distance = point_distance(mouse_cursor_x, mouse_cursor_y, target_cursor_x, target_cursor_y)-40;
        //Calculate the number of repetitions needed
        var _image_repeats = ceil(_lockon_distance/60);
        
        //Draw the line to the target from the cursor, leaving off the file image
        for(i = 0; i &lt; _image_repeats-1; i++)
            draw_sprite_general(spr_cursor_homing_line, -1, 0, 0, 60, 4, mouse_cursor_x+lengthdir_x(60*i+20, _lockon_direction), mouse_cursor_y+lengthdir_y(60*i+20, _lockon_direction), 1, 1, _lockon_direction, c_white, c_white, c_white, c_white, 0.6);
            
        //Draw enough of the final image to connect it
        var _distance_sofar = 60*i+20;
        draw_sprite_general(spr_cursor_homing_line, -1, 0, 0, round(_lockon_distance-_distance_sofar), 4, mouse_cursor_x+lengthdir_x(_distance_sofar, _lockon_direction), mouse_cursor_y+lengthdir_y(_distance_sofar, _lockon_direction), 1, 1, _lockon_direction, c_white, c_white, c_white, c_white, 0.6);
    
    }
    
draw_set_halign(fa_left);
    
//Draw the primary bar
//Calculate the size of the bar to be displayed
if(obj_player.primary_charge &gt;= obj_player.primary_charge_max)
{
    if(primary_charge_flash = 1)
    {
        draw_sprite_ext(spr_cursor, 5, mouse_cursor_x, mouse_cursor_y, 1, 1, 0, c_white, 0.9);
    }
    else
    {
        draw_sprite_ext(spr_cursor, 3, mouse_cursor_x, mouse_cursor_y, 1, 1, 0, c_white, 0.9);
    }
}
else
{
    if(obj_player.primary_charge = 0)
    {
        var primary_bar_size = (1-(obj_player.primary_cooldown_base/(obj_player.primary_cooldown_base*obj_player.primary_overheat)))*60;
        //Draw the remaining energy
        draw_sprite_part_ext(spr_cursor, 3, 0, primary_bar_size, 131, 60, mouse_cursor_x-59, mouse_cursor_y-30+primary_bar_size, 1, 1, c_white, 0.9);
        //Draw the empty bar
        draw_sprite_part_ext(spr_cursor, 4, 0, 0, 131, primary_bar_size, mouse_cursor_x-59, mouse_cursor_y-30, 1, 1, c_white, 0.9);
    }
    else
    {
        var primary_bar_size = (1-(obj_player.primary_charge/obj_player.primary_charge_max))*60;
        //Draw the remaining energy
        draw_sprite_part_ext(spr_cursor, 5, 0, primary_bar_size, 131, 60, mouse_cursor_x-59, mouse_cursor_y-30+primary_bar_size, 1, 1, c_white, 0.9);
        //Draw the empty bar
        draw_sprite_part_ext(spr_cursor, 3, 0, 0, 131, primary_bar_size, mouse_cursor_x-59, mouse_cursor_y-30, 1, 1, c_white, 0.9);
    }    
}
//Draw the number of uses remaining
var primary_rate_of_fire = round((60/(obj_player.primary_cooldown_base*obj_player.primary_overheat))*10)/10;
if(primary_rate_of_fire &gt;= 10)
    var primary_digits = 0;
else 
    var primary_digits = 1;

draw_text(mouse_cursor_x-52, mouse_cursor_y, string_format(primary_rate_of_fire, 2-primary_digits, primary_digits));
    
draw_sprite_ext(spr_cursor_weapons, cursor_weapon[1], mouse_cursor_x, mouse_cursor_y, 1, 1, 0, weapon_available_color[1], 0.9);
draw_sprite_ext(spr_cursor_weapons, cursor_weapon[2], mouse_cursor_x, mouse_cursor_y, 1, 1, 0, weapon_available_color[2], 0.9);
draw_sprite_ext(spr_cursor_weapons, cursor_weapon[3], mouse_cursor_x, mouse_cursor_y, 1, 1, 0, weapon_available_color[3], 0.9);
draw_sprite_ext(spr_cursor_weapons, cursor_weapon[4], mouse_cursor_x, mouse_cursor_y, 1, 1, 0, weapon_available_color[4], 0.9);
switch(selected_tab)
{
    case 1:
        draw_sprite_ext(spr_cursor_weapons_ammo, floor(global.secondary_stock[1]/global.secondary_cost[1]), mouse_cursor_x-cursor_weapon[1], mouse_cursor_y, 1, 1, 0, weapon_available_color[1], 0.9-current_secondary_name_alpha);
        draw_sprite_ext(spr_cursor_weapons_ammo, floor(global.secondary_stock[2]/global.secondary_cost[2])+5, mouse_cursor_x, mouse_cursor_y, 1, 1, 0, weapon_available_color[2], 0.9);
        draw_sprite_ext(spr_cursor_weapons_ammo, floor(global.secondary_stock[3]/global.secondary_cost[3])+10, mouse_cursor_x, mouse_cursor_y, 1, 1, 0, weapon_available_color[3], 0.9);
        draw_sprite_ext(spr_cursor_weapons_ammo, floor(global.secondary_stock[4]/global.secondary_cost[4])+15, mouse_cursor_x, mouse_cursor_y, 1, 1, 0, weapon_available_color[4], 0.9);    
    break;
    case 2:
        draw_sprite_ext(spr_cursor_weapons_ammo, floor(global.secondary_stock[1]/global.secondary_cost[1]), mouse_cursor_x, mouse_cursor_y, 1, 1, 0, weapon_available_color[1], 0.9);
        draw_sprite_ext(spr_cursor_weapons_ammo, floor(global.secondary_stock[2]/global.secondary_cost[2])+5, mouse_cursor_x-cursor_weapon[2]+8, mouse_cursor_y, 1, 1, 0, weapon_available_color[2], 0.9-current_secondary_name_alpha);
        draw_sprite_ext(spr_cursor_weapons_ammo, floor(global.secondary_stock[3]/global.secondary_cost[3])+10, mouse_cursor_x, mouse_cursor_y, 1, 1, 0, weapon_available_color[3], 0.9);
        draw_sprite_ext(spr_cursor_weapons_ammo, floor(global.secondary_stock[4]/global.secondary_cost[4])+15, mouse_cursor_x, mouse_cursor_y, 1, 1, 0, weapon_available_color[4], 0.9);    
    break;
    case 3:
        draw_sprite_ext(spr_cursor_weapons_ammo, floor(global.secondary_stock[1]/global.secondary_cost[1]), mouse_cursor_x, mouse_cursor_y, 1, 1, 0, weapon_available_color[1], 0.9);
        draw_sprite_ext(spr_cursor_weapons_ammo, floor(global.secondary_stock[2]/global.secondary_cost[2])+5, mouse_cursor_x, mouse_cursor_y, 1, 1, 0, weapon_available_color[2], 0.9);
        draw_sprite_ext(spr_cursor_weapons_ammo, floor(global.secondary_stock[3]/global.secondary_cost[3])+10, mouse_cursor_x-cursor_weapon[3]+16, mouse_cursor_y, 1, 1, 0, weapon_available_color[3], 0.9-current_secondary_name_alpha);
        draw_sprite_ext(spr_cursor_weapons_ammo, floor(global.secondary_stock[4]/global.secondary_cost[4])+15, mouse_cursor_x, mouse_cursor_y, 1, 1, 0, weapon_available_color[4], 0.9);    
    break;
    case 4:
        draw_sprite_ext(spr_cursor_weapons_ammo, floor(global.secondary_stock[1]/global.secondary_cost[1]), mouse_cursor_x, mouse_cursor_y, 1, 1, 0, weapon_available_color[1], 0.9);    
        draw_sprite_ext(spr_cursor_weapons_ammo, floor(global.secondary_stock[2]/global.secondary_cost[2])+5, mouse_cursor_x, mouse_cursor_y, 1, 1, 0, weapon_available_color[2], 0.9);
        draw_sprite_ext(spr_cursor_weapons_ammo, floor(global.secondary_stock[3]/global.secondary_cost[3])+10, mouse_cursor_x, mouse_cursor_y, 1, 1, 0, weapon_available_color[3], 0.9);
        draw_sprite_ext(spr_cursor_weapons_ammo, floor(global.secondary_stock[4]/global.secondary_cost[4])+15, mouse_cursor_x-cursor_weapon[4]+24, mouse_cursor_y, 1, 1, 0, weapon_available_color[4], 0.9-current_secondary_name_alpha);
    break;
}

draw_set_halign(fa_left);
draw_set_valign(fa_top);
draw_set_alpha(current_secondary_name_alpha);
if(selected_tab = 1 || selected_tab = 4)   
    var shift_name = 0;
else
    var shift_name = 3;
draw_text(mouse_cursor_x+70-cursor_weapon[selected_tab]+8*(selected_tab-1)+shift_name, mouse_cursor_y-45+15*selected_tab, current_secondary_name);


draw_set_alpha(1);

</string>
          </argument>
        </arguments>
      </action>
    </event>
    <event eventtype="9" enumb="115">
      <action>
        <libid>1</libid>
        <id>603</id>
        <kind>7</kind>
        <userelative>0</userelative>
        <isquestion>0</isquestion>
        <useapplyto>-1</useapplyto>
        <exetype>2</exetype>
        <functionname></functionname>
        <codestring></codestring>
        <whoName>self</whoName>
        <relative>0</relative>
        <isnot>0</isnot>
        <arguments>
          <argument>
            <kind>1</kind>
            <string>if window_get_fullscreen()
{
    window_set_fullscreen(false);
}
else
{
    window_set_fullscreen(true);
}
</string>
          </argument>
        </arguments>
      </action>
    </event>
    <event eventtype="9" enumb="51">
      <action>
        <libid>1</libid>
        <id>603</id>
        <kind>7</kind>
        <userelative>0</userelative>
        <isquestion>0</isquestion>
        <useapplyto>-1</useapplyto>
        <exetype>2</exetype>
        <functionname></functionname>
        <codestring></codestring>
        <whoName>self</whoName>
        <relative>0</relative>
        <isnot>0</isnot>
        <arguments>
          <argument>
            <kind>1</kind>
            <string>//Check if you are chatting
if(obj_mod.chat_open = true) exit;
audio_play_sound(snd_changeweapon, 1, 0);

secondary_selection_position = 82;
//Switch to the correct new attack
change_secondary(3);
</string>
          </argument>
        </arguments>
      </action>
    </event>
    <event eventtype="9" enumb="50">
      <action>
        <libid>1</libid>
        <id>603</id>
        <kind>7</kind>
        <userelative>0</userelative>
        <isquestion>0</isquestion>
        <useapplyto>-1</useapplyto>
        <exetype>2</exetype>
        <functionname></functionname>
        <codestring></codestring>
        <whoName>self</whoName>
        <relative>0</relative>
        <isnot>0</isnot>
        <arguments>
          <argument>
            <kind>1</kind>
            <string>//Check if you are chatting
if(obj_mod.chat_open = true) exit;
audio_play_sound(snd_changeweapon, 1, 0);
secondary_selection_position = 42;
//Switch to the correct new attack
change_secondary(2);
</string>
          </argument>
        </arguments>
      </action>
    </event>
    <event eventtype="9" enumb="49">
      <action>
        <libid>1</libid>
        <id>603</id>
        <kind>7</kind>
        <userelative>0</userelative>
        <isquestion>0</isquestion>
        <useapplyto>-1</useapplyto>
        <exetype>2</exetype>
        <functionname></functionname>
        <codestring></codestring>
        <whoName>self</whoName>
        <relative>0</relative>
        <isnot>0</isnot>
        <arguments>
          <argument>
            <kind>1</kind>
            <string>//Check if you are chatting
if(obj_mod.chat_open = true) exit;
audio_play_sound(snd_changeweapon, 1, 0);
secondary_selection_position = 2;
//Switch to the correct new attack
change_secondary(1);
</string>
          </argument>
        </arguments>
      </action>
    </event>
    <event eventtype="9" enumb="27">
      <action>
        <libid>1</libid>
        <id>603</id>
        <kind>7</kind>
        <userelative>0</userelative>
        <isquestion>0</isquestion>
        <useapplyto>-1</useapplyto>
        <exetype>2</exetype>
        <functionname></functionname>
        <codestring></codestring>
        <whoName>self</whoName>
        <relative>0</relative>
        <isnot>0</isnot>
        <arguments>
          <argument>
            <kind>1</kind>
            <string>if(global.musictoggle = 0)
{   
    audio_stop_all();
    audio_play_sound(music_quasar, 1, 1);
}
//Check if you are host
if(global.master = true)
{
 //Remove the game from the games list if you made the game on it
 if(global.public_game = true)
        sql_remove(global.myipaddress); 
 host_quit();
 //Set time until exiting the game
 alarm[1]=2;
 exit;
}
//If you are a client, send the disconnection message 
//to the host and return to the connecting
//room
clearbuffer(0);
writebyte(CLIENT_DROP, 0);
writebyte(global.mymid, 0);
writestring(global.name, 0);
if(obj_player.ismine = 1)
 writestring(global.name+" has RAGEQUIT the game.", 0)
else
 writestring(global.name+" has left the game.", 0) 
sendmessage(global.host, 0, 0, 0);
alarm[1]=4;
</string>
          </argument>
        </arguments>
      </action>
    </event>
    <event eventtype="9" enumb="13">
      <action>
        <libid>1</libid>
        <id>603</id>
        <kind>7</kind>
        <userelative>0</userelative>
        <isquestion>0</isquestion>
        <useapplyto>-1</useapplyto>
        <exetype>2</exetype>
        <functionname></functionname>
        <codestring></codestring>
        <whoName>self</whoName>
        <relative>0</relative>
        <isnot>0</isnot>
        <arguments>
          <argument>
            <kind>1</kind>
            <string>/*
switch(obj_mod.chat_open)
{
 case false:
      obj_mod.chat_open = true;
      global.playership[mid].ship_disabled = true;
      keyboard_string = '';
      //Send a prediction to show the stopping
      with(obj_player)
      {
       predictspeed = 2;
       predictturn = 0;
       thisturn = 0;
       //Send the prediction
       clearbuffer(0);
       packet_label_write(6, mid);
       writebyte(prediction_compress(predictturn, predictspeed, 0), 0);
       //Send to everyone if host
       if(global.master = true)
        client_sendall(1, 0);
       else
        //Send to host if client
        sendmessage(global.udpsock, global.playerip, global.playerport, 0);
      }
 break;
 case true:
      obj_mod.chat_open = false;
      if(global.playership[mid].ship_status_hacked = false &amp;&amp; global.activated[mid] = 1)
        global.playership[mid].ship_disabled = false;
      //Check if text was typed
      if(keyboard_string = '') break;
      
      //Send a prediction to show movement
      with(obj_player)
      {
        if(ship_status_hacked = false)
            ship_disabled = false;
       predictspeed = 0;
       predictturn = 0;
       thisturn = 0;
       //Send the prediction
       clearbuffer(0);
       packet_label_write(6, mid);
       writebyte(prediction_compress(predictturn, predictspeed, 0), 0);
       //Send to everyone if host
       if(global.master = true)
        client_sendall(1, 0);
       else
        //Send to host if client
        sendmessage(global.udpsock, global.playerip, global.playerport, 0);
      }      
      //create the new chat line and take note of its middle
      sendline = global.name+": "+ keyboard_string;
      middle = string_length(sendline)/2;
      //Break up text if there is no space near the middle
      if(string_replace(string_copy(sendline, middle-4, 8), ' ', '-') = string_copy(sendline, middle-4, 8) &amp;&amp; string_length(sendline) &gt; 30)
       sendline = string_insert(' ', sendline, middle);
            
      //Send it to your chat
      chatline_add(sendline, c_white);
      //Send the defeat to everyone
      clearbuffer(0);
      packet_label_write(7, mid);
      writestring(chatline[4], 0);
      //Send to everyone if host
      if(global.master = true)
       client_sendall(0, 0);
      else
       //Send to host if client
       sendmessage(global.host, 0, 0, 0);
 break;
} 
</string>
          </argument>
        </arguments>
      </action>
    </event>
  </events>
  <PhysicsObject>0</PhysicsObject>
  <PhysicsObjectSensor>0</PhysicsObjectSensor>
  <PhysicsObjectShape>0</PhysicsObjectShape>
  <PhysicsObjectDensity>0.5</PhysicsObjectDensity>
  <PhysicsObjectRestitution>0.100000001490116</PhysicsObjectRestitution>
  <PhysicsObjectGroup>0</PhysicsObjectGroup>
  <PhysicsObjectLinearDamping>0.100000001490116</PhysicsObjectLinearDamping>
  <PhysicsObjectAngularDamping>0.100000001490116</PhysicsObjectAngularDamping>
  <PhysicsObjectFriction>0.200000002980232</PhysicsObjectFriction>
  <PhysicsObjectAwake>-1</PhysicsObjectAwake>
  <PhysicsObjectKinematic>0</PhysicsObjectKinematic>
  <PhysicsShapePoints/>
</object>
